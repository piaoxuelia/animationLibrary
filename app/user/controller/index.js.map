{
    "version": 3,
    "sources": [
        "../../../src/user/controller/index.js"
    ],
    "names": [],
    "mappings": "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",
    "file": "../../../src/user/controller/index.js",
    "sourcesContent": [
        "'use strict';\n\nimport Base from './base.js';\n\n\nexport default class extends Base {\n\t/**\n\t * index action\n\t * @return {Promise} []\n\t */\n\n\tasync indexAction() {\n\t\t//auto render template file index_index.html\n\t\tlet user = await this.checkAuthor(this);\n\n\t\tif(user){\n\t\t\tthis.assign({ \n\t\t\t\tpage:\"user\",\n\t\t\t\ttitle:\"工具编辑\",\n\t\t\t\tuser:user\n\t\t\t})\n\t\t\treturn this.display();\n\t\t}\n\t}\n\n\tasync getcateAction() {\n\t\tlet model = this.model(\"CATE\");\n\t\ttry {\n\t\t\tlet result = await model.select();\n\t\t\tthis.success({ \"result\": result });\n\t\t} catch (e) {\n\t\t\tthis.fail(102, \"未成功\");\n\t\t}\n\n\t}\n\n\tasync getlistAction() {\n\t\tlet modelLIST = this.model(\"LIST\");\n\t\tlet modelCATE = this.model(\"CATE\");\n\n\t\t//连表查询然后先按 cateid 排序 然后按num 排序，num:是在某一个分类下的顺序\n\t\t\n\t\t\n\t\tlet result = await modelLIST.join({\n\t\t\tCONNECT: { join: \"left\", on: \"toolId, toolId\", as: \"c\" },\n\t\t\tCATE: { join: \"right\", on: [\"CATE.cateId\", \"c.cateId\"] }\n\t\t}).alias('d').order('c.cateId ASC,c.num asc').select();\n\n\t\tconsole.log(modelLIST.getLastSql());\n\n\t\tvar _cateid = '';\n\t\tvar resData = {};\n\t\tfor(var i =0; i<result.length ; i++){\n\t\t\tif(result[i].cateId === _cateid){\n\t\t\t\tresData[_cateid].data.push(result[i]);\n\t\t\t\tcontinue;\n\t\t\t}else{\n\t\t\t\t_cateid = result[i].cateId;\n\t\t\t\tresData[_cateid] = {};\n\t\t\t\tresData[_cateid].cateName =result[i].cateName;\n\t\t\t\tresData[_cateid].data = [];\n\t\t\t\tresData[_cateid].data.push(result[i]);\n\t\t\t}\n\t\t}\n\t\tthis.success({ \"result\": resData });\n\n\t}\n\t/* 改变工具相应分类下的展示顺序 */\n\tasync setnumAction() {\n\t\t\n\t\tlet coList = this.model(\"CONNECT\");\n\n\t\tvar toolData = JSON.parse(this.get('data'));\n\t\ttry{\n\t\t\tfor(var i in toolData){\n\t\t\t\tvar toolId = toolData[i].toolId,\n\t\t\t\t\tcateId = toolData[i].cateId,\n\t\t\t\t\tnum = toolData[i].num;\n\n\t\t\t\tawait coList.where({toolId:toolId,cateId:cateId}).update({num:num});\n\t\t\t}\n\t\t\tthis.success({ \"result\":\"成功\"});\n\t\t}catch(e){\n\t\t\tthis.fail(102, \"未成功\");\n\t\t}\n\t\n\t}\n\t/** 删除相应分类下的工具 \n\t *  此操作只能将相应分类下的工具记录删除，不能将此工具的所有记录删除 \n\t *  只删除CONNECT表中的记录\n\t**/\n\tasync dellistAction() {\n\t\tif(await this.checkAuthor()){\n\t\t\tlet coList = this.model(\"CONNECT\");\n\t\t\tvar toolData = JSON.parse(this.get('data'));\n\n\t\t\ttry{\n\t\t\t\tvar toolId = toolData.toolId,\n\t\t\t\t\tcateId = toolData.cateId\n\n\t\t\t\tawait coList.where({toolId:toolId,cateId:cateId}).delete();\n\t\t\t\t\n\t\t\t\tthis.success({ \"result\":\"删除成功\"});\n\t\t\t}catch(e){\n\t\t\t\tthis.fail(102, \"删除失败\");\n\t\t\t}\n\t\t}\n\t}\n\n\n\n\n\n\n\n\n\n\n\n\n\t//以下注释掉的代码是最初批量向数据库中插入数据的代码\n\t// async addAction(data) {\n\t// \tlet model = this.model(\"CATE\");\n\t// \tvar data = this.get('cateall');\n\t// \tdata = JSON.parse(data);\n\n\n\t// \ttry {\n\t// \t\tfor (var i in data) {\n\t// \t\t\tvar result = await model.add(data[i]);\n\t// \t\t\tthis.success({ \"result\": result });\n\t// \t\t}\n\t// \t} catch (e) {\n\t// \t\tthis.fail(102, \"未成功\");\n\t// \t}\n\t// }\n\n\t// async listAction(data) {\n\t// \tlet model = this.model(\"LIST\");\n\t// \tvar data = this.get('listdata');\n\t// \tdata = JSON.parse(data);\n\n\n\t// \ttry {\n\t// \t\tfor (var i in data) {\n\t// \t\t\tfor (var j in data[i]) {\n\t// \t\t\t\tvar result = await model.add(data[i][j]);\n\t// \t\t\t\tthis.success({ \"result\": result });\n\t// \t\t\t}\n\t// \t\t}\n\t// \t} catch (e) {\n\t// \t\tthis.fail(102, \"未成功\");\n\t// \t}\n\t// }\n\n}"
    ]
}